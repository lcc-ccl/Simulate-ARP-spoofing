实验算法
1.	伪造ARP响应包：
o	设置源IP地址为网关IP，目标IP地址为目标设备IP。
 
o	源MAC地址设置为攻击者的MAC地址（或自定义MAC地址）。
 
o	构造ARP响应包，操作码（arp_op）设置为ARPOP_REPLY，表示这是一个响应包。
2.	持续发送伪造的ARP包：
o	持续发送伪造的ARP响应包，以保持目标设备的ARP缓存中“网关IP对应攻击者MAC地址”的记录，使欺骗效果持久。
 

程序结构
1.	初始化部分
o	创建一个原始套接字（SOCK_RAW），协议类型为ETH_P_ARP，用于发送ARP数据包。
 
o	使用 ioctl 获取本地网络接口的索引（ifindex），并存储用于配置发送的套接字地址。
o	获取本地接口的MAC地址（攻击者的真实MAC地址）并输出以便调试。
2.	构造ARP欺骗包
o	调用 fill_arp_reply_packet 函数构造ARP响应包。
	源MAC地址：设为攻击者的MAC地址或自定义MAC地址，伪装为网关MAC地址。
	源IP地址：设为网关的IP地址，伪装为网关IP。
	目标MAC地址：设为目标设备的MAC地址。
	目标IP地址：设为目标设备的IP地址。
o	该包构造完成后，将使用以太网帧封装，发送到目标设备。
 
3.	持续发送ARP欺骗包
o	将构造的ARP响应包复制到数据缓冲区中，通过sendto函数持续发送ARP欺骗包。
o	以 1 秒的间隔发送，以保证目标设备的ARP缓存被持续更新为伪造的MAC-IP绑定
  
实验记录；
被攻击机：
 
攻击机运行程序：
 
抓包观察到发出的arp响应包：
 
被攻击机的arp被修改：
 





  
本次实验实现了通过ARP欺骗技术执行中间人攻击（MITM）的过程，成功模拟了在局域网中拦截和重定向网络流量的攻击手法。通过伪造的ARP响应包，将攻击者的MAC地址冒充为网关的MAC地址，诱导目标设备更新ARP缓存，实现流量的劫持。
实验成果
1.	深入理解ARP协议：实验帮助我们理解了ARP协议的工作机制及其安全隐患。ARP协议设计中缺乏对源验证的措施，使其容易受到伪造和篡改的影响，这是ARP欺骗的根本原因。
2.	掌握ARP欺骗的原理与实现：通过实验，我们学习了如何使用原始套接字构造和发送自定义的ARP数据包。掌握了ARP响应包的构造方法，包括如何设置伪造的源IP、源MAC等字段，使目标设备误认为攻击者设备是网关。
3.	实验验证成功：在目标设备上验证了实验结果，目标设备的ARP缓存被更新为攻击者的MAC地址，从而将流量重定向到攻击者。通过抓包工具观察，成功确认了伪造的ARP响应包的发送过程。
实验收获
•	提高了网络安全意识：通过实验，了解了ARP欺骗的攻击手法及其潜在威胁，意识到局域网环境中的ARP欺骗攻击可能导致的安全问题。
•	增强了网络协议和套接字编程技能：学习了如何利用原始套接字在数据链路层进行通信，进一步掌握了网络协议底层的工作原理。




